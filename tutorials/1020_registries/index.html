<!DOCTYPE html><html><head><meta charset="utf-8"><title>Registry | Dojo</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Working with the RegistryOverviewFlexibility to override the default type of a widget’s children provides a powerful configuration option when it comes to using and customizing widgets with any web a"><meta property="og:type" content="website"><meta property="og:title" content="Registry"><meta property="og:url" content="https://dojo.github.io/tutorials/1020_registries/index.html"><meta property="og:site_name" content="Dojo"><meta property="og:description" content="Working with the RegistryOverviewFlexibility to override the default type of a widget’s children provides a powerful configuration option when it comes to using and customizing widgets with any web a"><meta property="og:image" content="https://dojo.github.io/tutorials/1020_registries/images/lazy-load-widget.gif"><meta property="og:updated_time" content="2017-09-29T14:16:59.901Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Registry"><meta name="twitter:description" content="Working with the RegistryOverviewFlexibility to override the default type of a widget’s children provides a powerful configuration option when it comes to using and customizing widgets with any web a"><meta name="twitter:image" content="https://dojo.github.io/tutorials/1020_registries/images/lazy-load-widget.gif"><meta name="twitter:creator" content="@https://twitter.com/dojo"><link rel="alternate" href="/atom.xml" title="Dojo" type="application/atom+xml"><link rel="icon" href="/images/favicons/favicon.ico"><link rel="stylesheet" href="/css/main.css"><script type="text/javascript">!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-3242977-15","auto"),ga("send","pageview")</script><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body class="body-tutorial"><header class="container site-header"><div class="content-container"><div class="row"><nav class="site-nav"><a href="/" class="header-logo"><img src="/images/dojo2-logo-white.svg" alt="Dojo"></a><a class="main-nav-link" href="/tutorials">Tutorials</a> <a class="main-nav-link" href="/api">API</a> <a class="main-nav-link" href="/blog/2017/03/27/Dojo-2-is-coming">Blog</a> <a class="main-nav-link main-nav-icon-link" href="https://github.com/dojo/meta"><img src="/images/logos/github-white.svg" alt="Dojo on Github" class="nav-icon github"></a></nav></div></div></header><div class="page-content"><section class="content-container" id="main"><div class="tutorial-content"><div class="scrollable"><section class="tutorial hidden hiding"><h1 id="Working-with-the-Registry"><a href="#Working-with-the-Registry" class="headerlink" title="Working with the Registry"></a>Working with the Registry</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Flexibility to override the default type of a widget’s children provides a powerful configuration option when it comes to using and customizing widgets with any web application. Additionally, as web applications grow, the physical size of the resources required to load the application becomes increasingly critical. Keeping the size of resources required to load a web application as small as possible ensures that the application can provide an optimal performance for all users. To help with these challenges, Dojo 2 provides a concept of a <code>registry</code> that can be used to achieve both of these goals in a simple and effective manner, without intruding on the existing development experience.</p><p>In this tutorial, we will start with an application that uses concrete widget classes and request all assets when the application first loads. First we will swap all the concrete widget references to load the widgets from a <code>registry</code>. Then we will create a new widget that will be lazily loaded when the worker card is clicked the first time.</p><h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>You can <a href="../assets/1020_registries-initial.zip">download</a> the demo project and run <code>npm install</code> to get started.</p><p>The <code>@dojo/cli</code> command line tool should be installed globally. Refer to the <a href="../000_local_installation/">Dojo 2 local installation</a> article for more information.</p><p>You also need to be familiar with TypeScript as Dojo 2 uses it extensively. For more information, refer to the <a href="../comingsoon.html">TypeScript and Dojo 2</a> article.</p></section><section class="tutorial hidden hiding"><h2 id="The-default-registry"><a href="#The-default-registry" class="headerlink" title="The default registry"></a>The default registry</h2><div class="task">Create a default registry.</div><p>The first step is to create a <code>registry</code> that will be made available to the application by passing the instance as the <code>registry</code> property on the <code>projector</code>.</p><div class="instruction">Add the <code>Registry</code> import to the <code>main.ts</code> module.</div><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> WidgetRegistry <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/widget-core/WidgetRegistry'</span><span class="token punctuation">;</span>
</code></pre><div class="instruction">Now, create a <code>Registry</code> instance.</div><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> registry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WidgetRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="instruction">And finally set the <code>registry</code> on the <code>projector</code>.</div><pre class="language-javascript"><code class="language-javascript">projector<span class="token punctuation">.</span><span class="token function">setProperties</span><span class="token punctuation">(</span><span class="token punctuation">{</span> registry <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><article class="aside"><strong>Registries Everywhere!</strong><p>A <code>registry</code> can also be used to define widgets with non-visual responsibilities, such as state injection and routing. To learn more, take a look at the <a href="../1010_containers_and_injecting_state/">container tutorial</a> and <a href="../comingsoon.html">routing tutorial</a> .</p></article><p>At the moment we haven’t affected the application, however we now have a handle to a <code>registry</code> where we can start to define widgets. Once the widgets are defined in the <code>registry</code>, they will be available through the application and can be used by switching the concrete class in <code>w()</code> with the <code>registry</code> label.</p><div class="instruction">Add the widget imports to <code>main.ts</code>.</div><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'@dojo/widgets/button/Button'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> TextInput <span class="token keyword">from</span> <span class="token string">'@dojo/widgets/textinput/TextInput'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Banner <span class="token keyword">from</span> <span class="token string">'./widgets/Banner'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> WorkerForm <span class="token keyword">from</span> <span class="token string">'./widgets/WorkerForm'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> WorkerContainer <span class="token keyword">from</span> <span class="token string">'./widgets/WorkerContainer'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Worker <span class="token keyword">from</span> <span class="token string">'./widgets/Worker'</span><span class="token punctuation">;</span>
</code></pre><div class="instruction">Then define widgets in the <code>registry</code>.</div><pre class="language-javascript"><code class="language-javascript">registry<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'dojo-button'</span><span class="token punctuation">,</span> Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
registry<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'dojo-text-input'</span><span class="token punctuation">,</span> TextInput<span class="token punctuation">)</span><span class="token punctuation">;</span>
registry<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'banner'</span><span class="token punctuation">,</span> Banner<span class="token punctuation">)</span><span class="token punctuation">;</span>
registry<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'worker'</span><span class="token punctuation">,</span> Worker<span class="token punctuation">)</span><span class="token punctuation">;</span>
registry<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'worker-form'</span><span class="token punctuation">,</span> WorkerForm<span class="token punctuation">)</span><span class="token punctuation">;</span>
registry<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'worker-container'</span><span class="token punctuation">,</span> WorkerContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>In the next section we will use the registry label in our render functions.</p></section><section class="tutorial hidden hiding"><h2 id="Using-registry-items"><a href="#Using-registry-items" class="headerlink" title="Using registry items"></a>Using registry items</h2><p>Now that the <code>registry</code> has been made available to the application and the widgets have been defined, we can use the label instead of the widget classes across the application.</p><div class="instruction">Use registry labels in <code>App.ts</code>'s render function.</div><pre class="language-javascript"><code class="language-javascript">	<span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
			w<span class="token operator">&lt;</span>Banner<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">'banner'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			w<span class="token operator">&lt;</span>WorkerForm<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">'worker-form'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
				formData<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker<span class="token punctuation">,</span>
				onFormInput<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_onFormInput<span class="token punctuation">,</span>
				onFormSave<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_addWorker
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			w<span class="token operator">&lt;</span>WorkerContainer<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">'worker-container'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
				workerData<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_workerData
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre><p>Notice that we are passing a generic type to the <code>w()</code> function call, this is because when using a <code>registry</code> label it is unable to infer the properties interface. As a result falls back to the default, <code>WidgetProperties</code> interface. Passing the generic tells <code>w()</code> the type of widget the label represents in the <code>registry</code> and will correctly enforce the widget’s properties interface.</p><div class="instruction">Use registry labels in <code>WorkerContainer.ts</code>'s render function.</div><pre class="language-javascript"><code class="language-javascript">		<span class="token keyword">const</span> workers <span class="token operator">=</span> workerData<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>worker<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=></span> w<span class="token operator">&lt;</span>Worker<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">'worker'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
			key<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`worker-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>
			<span class="token operator">...</span>worker
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="instruction">Use registry labels in <code>WorkerForm.ts</code>'s render function.</div><pre class="language-javascript"><code class="language-javascript">	<span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>
			formData<span class="token punctuation">:</span> <span class="token punctuation">{</span> firstName<span class="token punctuation">,</span> lastName<span class="token punctuation">,</span> email <span class="token punctuation">}</span>
		<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'form'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
			classes<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>workerForm<span class="token punctuation">)</span><span class="token punctuation">,</span>
			onsubmit<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_onSubmit
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
			<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'fieldset'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> classes<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>nameField<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
				<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'legend'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> classes<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>nameLabel<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> <span class="token string">'Name'</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				w<span class="token operator">&lt;</span>TextInput<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">'dojo-text-input'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
					key<span class="token punctuation">:</span> <span class="token string">'firstNameInput'</span><span class="token punctuation">,</span>
					label<span class="token punctuation">:</span> <span class="token punctuation">{</span>
						content<span class="token punctuation">:</span> <span class="token string">'First Name'</span><span class="token punctuation">,</span>
						hidden<span class="token punctuation">:</span> <span class="token boolean">true</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					placeholder<span class="token punctuation">:</span> <span class="token string">'First name'</span><span class="token punctuation">,</span>
					value<span class="token punctuation">:</span> firstName<span class="token punctuation">,</span>
					required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
					onInput<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onFirstNameInput
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				w<span class="token operator">&lt;</span>TextInput<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">'dojo-text-input'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
					key<span class="token punctuation">:</span> <span class="token string">'lastNameInput'</span><span class="token punctuation">,</span>
					label<span class="token punctuation">:</span> <span class="token punctuation">{</span>
						content<span class="token punctuation">:</span> <span class="token string">'Last Name'</span><span class="token punctuation">,</span>
						hidden<span class="token punctuation">:</span> <span class="token boolean">true</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					placeholder<span class="token punctuation">:</span> <span class="token string">'Last name'</span><span class="token punctuation">,</span>
					value<span class="token punctuation">:</span> lastName<span class="token punctuation">,</span>
					required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
					onInput<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onLastNameInput
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			w<span class="token operator">&lt;</span>TextInput<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">'dojo-text-input'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
				label<span class="token punctuation">:</span> <span class="token string">'Email address'</span><span class="token punctuation">,</span>
				type<span class="token punctuation">:</span> <span class="token string">'email'</span><span class="token punctuation">,</span>
				value<span class="token punctuation">:</span> email<span class="token punctuation">,</span>
				required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
				onInput<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onEmailInput
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			w<span class="token operator">&lt;</span>Button<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">'dojo-button'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> <span class="token string">'Save'</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre><p>Next, we will create a widget that is lazily loaded when needed!</p></section><section class="tutorial hidden hiding"><h2 id="Lazy-loading-widgets"><a href="#Lazy-loading-widgets" class="headerlink" title="Lazy loading widgets"></a>Lazy loading widgets</h2><p>First we need to extract the <code>_renderBack</code> function from <code>Worker.ts</code> into a new widget, <code>WorkerBack.ts</code>, and then add the new widget to the registry.</p><div class="task">Add the following code in <code>WorkerBack.ts</code></div><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> WidgetBase <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/widget-core/WidgetBase'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> v <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/widget-core/d'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> theme<span class="token punctuation">,</span> ThemeableMixin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/widget-core/mixins/Themeable'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> css <span class="token keyword">from</span> <span class="token string">'../styles/workerBack.css'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">WorkerBackProperties</span> <span class="token punctuation">{</span>
	firstName<span class="token operator">?</span><span class="token punctuation">:</span> string<span class="token punctuation">;</span>
	lastName<span class="token operator">?</span><span class="token punctuation">:</span> string<span class="token punctuation">;</span>
	email<span class="token operator">?</span><span class="token punctuation">:</span> string<span class="token punctuation">;</span>
	timePerTask<span class="token operator">?</span><span class="token punctuation">:</span> number<span class="token punctuation">;</span>
	tasks<span class="token operator">?</span><span class="token punctuation">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> WorkerBackBase <span class="token operator">=</span> <span class="token function">ThemeableMixin</span><span class="token punctuation">(</span>WidgetBase<span class="token punctuation">)</span><span class="token punctuation">;</span>

@<span class="token function">theme</span><span class="token punctuation">(</span>css<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">WorkerBack</span> <span class="token keyword">extends</span> <span class="token class-name">WorkerBackBase</span><span class="token operator">&lt;</span>WorkerBackProperties<span class="token operator">></span> <span class="token punctuation">{</span>

	<span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>
			firstName <span class="token operator">=</span> <span class="token string">'firstName'</span><span class="token punctuation">,</span>
			lastName <span class="token operator">=</span> <span class="token string">'lastName'</span><span class="token punctuation">,</span>
			email <span class="token operator">=</span> <span class="token string">'unavailable'</span><span class="token punctuation">,</span>
			timePerTask <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
			tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token punctuation">[</span>
			<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
				classes<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>imageSmall<span class="token punctuation">)</span><span class="token punctuation">,</span>
				src<span class="token punctuation">:</span> <span class="token string">'images/worker.svg'</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
				classes<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>generalInfo<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
				<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
					classes <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>label<span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>lastName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>firstName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
					classes<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>label<span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Email'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>email<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
					classes<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>label<span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Avg. Time per Task'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>timePerTask<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
				<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'strong'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Current Tasks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> tasks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>task <span class="token operator">=></span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> classes<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>task<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> task <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="task">Add <code>w</code> import to <code>Worker.ts</code></div><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> v<span class="token punctuation">,</span> w <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/widget-core/d'</span><span class="token punctuation">;</span>
</code></pre><div class="task">Add <code>WorkerBack</code> import to <code>Worker.ts</code></div><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> WorkerBack <span class="token keyword">from</span> <span class="token string">'./WorkerBack'</span><span class="token punctuation">;</span>
</code></pre><div class="task">Update the <code>_renderBack</code> function to use the <code>WorkerBack</code> registry items in <code>Worker.ts</code></div><pre class="language-javascript"><code class="language-javascript">	<span class="token keyword">private</span> <span class="token function">_renderBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>
			firstName <span class="token operator">=</span> <span class="token string">'firstName'</span><span class="token punctuation">,</span>
			lastName <span class="token operator">=</span> <span class="token string">'lastName'</span><span class="token punctuation">,</span>
			email <span class="token operator">=</span> <span class="token string">'unavailable'</span><span class="token punctuation">,</span>
			timePerTask <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
			tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
				classes<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span>css<span class="token punctuation">.</span>workerBack<span class="token punctuation">)</span><span class="token punctuation">,</span>
				onclick<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>flip
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_isFlipped <span class="token operator">?</span> w<span class="token operator">&lt;</span>WorkerBack<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">'worker-back'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> firstName<span class="token punctuation">,</span> lastName<span class="token punctuation">,</span> email<span class="token punctuation">,</span> timePerTask<span class="token punctuation">,</span> tasks <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">null</span> <span class="token punctuation">]</span>
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre><article class="aside"><strong>Use Before You Define</strong><p>The <code>registry</code> is designed to mirror the behavior and API of custom elements wherever possible. One neat feature is that a registry item can be used before it is defined, and, once defined, an used before it is defined and, once defined, widgets that use the <code>registry</code> will automatically re-render!</p></article><p>Now we need to add the <code>registry</code> definition for <code>WorkerBack.ts</code> to lazily load when the worker is clicked. Instead of adding a concrete widget class, we add a function that, when called, requires and returns the concrete widget. This function will not be called until the first time the application tries to use the widget label as part of the usual <code>render</code> cycle. Initially, before the widget has loaded, nothing will be rendered. Once it has loaded, any widgets that use the lazy widget will automatically re-render.</p><div class="task">Import <code>load</code> from <code>@dojo/core/load</code> in <code>main.ts</code></div><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> load <span class="token keyword">from</span> <span class="token string">'@dojo/core/load'</span><span class="token punctuation">;</span>
</code></pre><div class="task">Import the <code>Require</code> interface and define the type of <code>require</code></div><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Require <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/interfaces/loader'</span><span class="token punctuation">;</span>

declare <span class="token keyword">const</span> require<span class="token punctuation">:</span> Require<span class="token punctuation">;</span>
</code></pre><p>The default type of <code>require</code> needed to be overridden, with the type of require that we know will be available at runtime.</p><div class="task">Now define a function that lazily loads <code>WorkerBack.ts</code> in the registry</div><pre class="language-javascript"><code class="language-javascript">registry<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'worker-back'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">load</span><span class="token punctuation">(</span>require<span class="token punctuation">,</span> <span class="token string">'./widgets/WorkerBack'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>WorkerBack<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> WorkerBack<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Now that the <code>WorkerBack</code> widget is defined to load lazily, running the application with the browser developer tools open should show that the <code>WorkerBack.js</code> file is only loaded when a worker card is clicked on for the first time:</p><article class="aside"><strong>Auto Bundling Support</strong><p>To fully support lazy loading, the Dojo CLI build command will automatically bundle any lazily defined widgets into their own separate file! To learn more, take a look at the <a href="../comingsoon.html">build command tutorial</a>.</p></article><p><img src="./images/lazy-load-widget.gif" alt="lazy loading gif"></p></section><section class="tutorial hidden hiding"><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>In summary, the Registry is a powerful tool for decoupling components from their point of usage. Removing the complexity of dealing with when or how a widget is loaded from the end user means they can author widgets in the same familiar way, while also leveraging the benefits of lazy loading and extensibility as hopefully shown in this tutorial.</p><p>If you would like, you can download the completed <a href="../assets/1020_registries-finished.zip">demo application</a> from this tutorial.</p></section></div><div id="actionBar" class="action-bar"></div><style>body,html{height:100%}</style><script src="/js/tutorial-support.js"></script><script>tutorial.populateActionBar(document.getElementById("actionBar"))</script></div></section></div><div><footer class="page-footer"><div class="content-container"><div class="footer-logo"><img src="/images/logos/dojo-logo-black.svg"></div><div class="info">&copy; JS Foundation, All Rights Reserved.</div></div></footer><script src="/js/combined.js"></script></div></body></html>